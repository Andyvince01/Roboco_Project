version: '3.1'

# Intents
intents:
- affirm
- count_people
- deny
- doubt
- goodbye
- greet
- mood_great
- mood_unhappy
- finding_someone

# Entities
entities:
- gender
- clothing
- passages
- color
- store_name
- negation
- place
- time

# Slots
slots:
  dummy:
    type: any
    influence_conversation: false
    mappings:
    - type: custom
      action: global_slot_mapping
  gender:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
      - type: from_entity
        entity: gender
  upper_color:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
      - type: from_entity
        entity: color
        conditions:
        - active_loop: find_person_form
          requested_slot: upper_color
      - type: from_intent
        intent: doubt
        value: None
        conditions:
        - active_loop: find_person_form
          requested_slot: upper_color
  lower_color:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
      - type: from_entity
        entity: color
        conditions:
        - active_loop: find_person_form
          requested_slot: upper_color
      - type: from_intent
        intent: doubt
        value: None
        conditions:
        - active_loop: find_person_form
          requested_slot: lower_color
  bag:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
      - type: from_intent
        intent: affirm
        value: true
        conditions:
        - active_loop: find_person_form
          requested_slot: bag
      - type: from_intent
        intent: deny
        value: false
        conditions:
        - active_loop: find_person_form
          requested_slot: bag
      - type: from_intent
        intent: doubt
        value: None
        conditions:
        - active_loop: find_person_form
          requested_slot: bag
  hat:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
      - type: from_intent
        intent: affirm
        value: true
        conditions:
        - active_loop: find_person_form
          requested_slot: hat
      - type: from_intent
        intent: deny
        value: false
        conditions:
        - active_loop: find_person_form
          requested_slot: hat
      - type: from_intent
        intent: doubt
        value: None
        conditions:
        - active_loop: find_person_form
          requested_slot: hat

# Predefined Responses
responses:
  utter_greet:
    - text: Hey! I'm Pepper, the robotic guardian of this shopping mall. How can I help you?
    - text: Hello! I'm Pepper, the robotic guardian of this shopping mall. How may I help you?
    - text: Hello there! I'm Pepper, the robotic guardian of this shopping mall. How can I assist you?
  utter_cheer_up:
    - text: "Here is something to cheer you up:"
      image: https://i.imgur.com/nGF1K8f.jpg
  utter_did_that_help:
    - text: Did that help you?
  utter_happy:
    - text: Great, carry on!
  utter_goodbye:
    - text: Bye!
    - text: Goodbye!
    - text: Bye-bye!
    - text: Have a nice day!
    - text: Have a great rest of your day!
  utter_submit_find_person_form:
    - text: "Let me check in my database. I am going to run a people search using the following parameters:\n
        - gender: {gender} \n
        - upper color: {upper_color} \n
        - lower color: {lower_color} \n
        - bag: {bag} \n
        - hat: {hat} \n
        Only a few seconds of patience!"
  utter_ask_gender:
    - text: What is the gender?
  utter_ask_upper_color:
    - text: What is the color of upper garment?
  utter_ask_lower_color:
    - text: What is the color of lower garment?
  utter_ask_bag:
    - text: Does the person you are looking for have a bag?
  utter_ask_hat:
    - text: Does the person you are looking for have a hat?
  utter_doubt_intent:
    - text: Don't worry. It is normal to be upset in these situations. I will do my best to help you.
    - text: Don't fret. It's completely normal to feel this way in such situations. I'll do everything I can to assist you.
    - text: No worries. Feeling upset is normal. I'll do my best.
    - text: There's no need for concern. It's understandable to be upset under these circumstances. I'll do all I can to aid you.
    - text: Don't panic. It's alright to be upset. I'll do my best to provide assistance.
  utter_please_rephrase:
    - text: I'm sorry, I didn't quite understand that. Could you rephrase? Remember. My duties are limited to counting and identifying the number of people in the shopping mall.
# Actions
actions:
  - validate_find_person_form
  - global_slot_mapping
  - action_submit
  - action_count_people

# Forms
forms:
  find_person_form:
    ignored_intents: 
      - count_people
    required_slots:
      - gender
      - upper_color
      - lower_color
      - bag
      - hat